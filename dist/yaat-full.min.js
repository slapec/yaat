angular.module("yaat",[]).controller("YATableController",["$scope","$http",function(e,a){var t=this;e.$limit=25,e.update=function(r){void 0!==r&&t.applyOrder(r),a({method:"POST",url:e.$api,data:e.$headers}).success(function(e){t.parse(e)})},e.$watch("$api",function(){t.init(e.$api)}),this.init=function(e){void 0!==e&&a({method:"POST",url:e}).success(function(e){t.parse(e)})},this.parse=function(a){for(var t=[],r=[],i=0;i<a.columns.length;i++){var l=a.columns[i];t.push(l),l.hidden===!1&&r.push(l)}e.$headers=t,e.$visibleHeaders=r,e.$rows=a.rows},this.applyOrder=function(a){for(var t=$(a).sortable("toArray"),r=[],i=0;i<t.length;i++)for(var l=0;l<e.$headers.length;l++)if(t[i]===e.$headers[l].key){r.push(e.$headers.splice(l,1));break}e.$headers=r},window.getScope=function(){return e}}]).directive("yat",[function(){return{restrict:"E",controller:"YATableController",templateUrl:"yatable/table.html",scope:!0,link:function(e,a,t){void 0!==t.api&&(e.$api=t.api),void 0!==t.limit&&(e.$limit=t.limit);var r=function(){e.update(this)},i=e.$sortableOptions;if(void 0!==i)i.hasOwnProperty("update")||(i.update=r);else var i={axis:"y",containment:"parent",tolerance:"pointer",update:r};var l=$(a).find(".ya-headers");l.disableSelection(),l.sortable(i)}}}]),angular.module("yaat").run(["$templateCache",function(e){e.put("yatable/table.html",'<div class="yat"><div class="ya-ctrls"><ol class="ya-headers"><li ng-repeat="header in $headers" id="{{ header.key }}"><input type="checkbox" ng-model="header.hidden" ng-click="update()"> <span class="ya-header-value">{{ header.value }}</span> <input type="checkbox" ng-model="header.desc" ng-click="update()"></li></ol></div><table class="ya-table"><thead><tr><td ng-repeat="header in $visibleHeaders">{{ header.value }}</td></tr></thead><tbody><tr ng-repeat="row in $rows"><td ng-repeat="cell in row.values">{{ cell }}</td></tr></tbody></table><pre class="ya-debug">$headers={{ $headers }}\n$visibleHeaders={{ $visibleHeaders }}\n$limit={{ $limit }}\n</pre></div>')}]);